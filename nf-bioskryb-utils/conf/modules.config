common_resource_labels = [
    pipeline_user                : params.pipeline_user,
    basejumper_organization_name : params.basejumper_organization_name,
    basejumper_workspace_name    : params.basejumper_workspace_name,
    basejumper_project_name      : params.basejumper_project_name,
    pipeline_name                : params.pipeline_name,
    basejumper_organization_uuid : params.basejumper_organization_uuid,
    basejumper_workspace_uuid    : params.basejumper_workspace_uuid,
    basejumper_project_uuid      : params.basejumper_project_uuid,
    basejumper_pipeline_uuid     : params.basejumper_pipeline_uuid,
    pipeline_biosample_count     : params.pipeline_biosample_count
]

process {



    withName: 'DEEPVARIANT_MAKE_EXAMPLES.*' {
        container = "google/deepvariant:1.8.0"
        errorStrategy = { task.attempt <= 2 ? 'retry' : 'ignore' }
        maxRetries    = 2
        queue       = { task.attempt <= 1 ? 'intense-spot' : 'intense-ondemand' }
        cpus        = 62
        memory      = 246.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "DEEPVARIANT_MAKE_EXAMPLES"
            ]
    }
    
    withName: 'DEEPVARIANT_CALL_VARIANTS.*' {
        container = "google/deepvariant:1.8.0-gpu"
        errorStrategy = { task.attempt <= 2 ? 'retry' : 'ignore' }
        maxRetries = 2
        containerOptions = '--gpus all'
        queue = { task.attempt <= 1 ? 'intense-gpu-spot' : 'intense-gpu-ondemand' }
        accelerator = 1
        cpus = 8
        memory = 30.GB
        time = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "DEEPVARIANT_CALL_VARIANTS"
            ]
    }

    withName: 'DEEPVARIANT_POSTPROCESS.*' {
        container = "google/deepvariant:1.8.0"
        errorStrategy = { task.attempt <= 2 ? 'retry' : 'ignore' }
        maxRetries = 2
        queue = { task.attempt <= 1 ? 'intense-spot' : 'intense-ondemand' }
        cpus = 62
        memory = 246.GB
        time = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "DEEPVARIANT_POSTPROCESS"
            ]
    }


    withName: 'GOOGLE_DEEPVARIANT_FASTPIPELINE_GPU' {
        container = "google/deepvariant:1.8.0-gpu"
        errorStrategy = { task.attempt <= 2 ? 'retry' : 'ignore' }
        maxRetries = 2
        queue = { task.attempt <= 2 ? 'intense-gpu-spot' : 'intense-gpu-ondemand' }
        accelerator = 4
        cpus = 48
        memory = 180.GB
        time = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "GOOGLE_DEEPVARIANT_FASTPIPELINE_GPU"
            ]
    }


    withName: 'GOOGLE_DEEPVARIANT_GPU' {
        container = "google/deepvariant:1.8.0-gpu"
        errorStrategy = { task.attempt <= 2 ? 'retry' : 'ignore' }
        maxRetries = 2
        queue = { task.attempt <= 2 ? 'intense-gpu-spot' : 'intense-gpu-ondemand' }
        accelerator = 4
        cpus = 48
        memory = 180.GB
        time = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "GOOGLE_DEEPVARIANT_GPU"
            ]
    }


    withName: 'GOOGLE_DEEPVARIANT_CPU' {
        container = "google/deepvariant:1.8.0"
        errorStrategy = { task.attempt <= 2 ? 'retry' : 'ignore' }
        maxRetries    = 2
        queue       = 'intense-spot'
        cpus        = 62
        memory      = 246.GB
        time        = 5.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "GOOGLE_DEEPVARIANT_CPU"
            ]
    }

    withName: 'HAPPY' {
        container = 'quay.io/biocontainers/hap.py:0.3.14--py27h5c5a3ab_0'
        queue = 'large-spot'
        cpus = 4
        memory = 15.GB
        time = 2.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "HAPPY"
        ]
    }

    // BOWTIE2_BUILD
    withName: 'BOWTIE2_BUILD' {
        container = "quay.io/biocontainers/bowtie2:2.5.4--he96a11b_5"
        queue = 'large-spot'
        cpus = 8
        memory = 15.GB
        time = 24.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BOWTIE2_BUILD"
        ]
    }
    

    // BOWTIE2_ALIGN
    withName: 'BOWTIE2_ALIGN' {
        container = "quay.io/biocontainers/bowtie2:2.5.4--he96a11b_5"
        queue = 'large-spot'
        cpus = 8
        memory = 15.GB
        time = 24.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "BOWTIE2_ALIGN"
        ]
    }
      
    
    withName: 'SENTIEON_CNVSCOPE' {
        queue       = { task.attempt <= 1 ? 'intense-spot' : 'intense-ondemand' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        container = 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-03-1'
        cpus        = 64
        memory      = 123.GB
        time        = 24.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "SENTIEON_CNVSCOPE"
        ]
    }


    withName: 'CNVSCOPE_REPORT' {
        queue       = { task.attempt <= 1 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:cnvscope_report_0.1'
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "CNVSCOPE_REPORT"
        ]
    }



    withName: 'PUBLISH_INPUT_DATASET' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:ubuntu_24.04_stable"
        queue = 'small-spot'
        cpus        = 2
        memory      = 3.GB
        time        = 1.h
        resourceLabels = 
                common_resource_labels + [
                pipeline_process_name: "PUBLISH_INPUT_DATASET"
        ]

    }

    withName: 'MULTIQC' {
            queue       = { task.attempt > 1 ? 'large-ondemand' : 'small-ondemand' }
            container   = "quay.io/biocontainers/multiqc:1.28--pyhdfd78af_0"
            errorStrategy = { task.attempt <=2 ? 'retry' : 'terminate' }
            cpus        = { 2 * task.attempt }
            memory      = { 7.GB * task.attempt }
            time        = { 5.h }
            resourceLabels = common_resource_labels + [
            pipeline_process_name : "MULTIQC"
        ]

    }

    withName: 'MULTIQC_FOR_PARABRICKS' {
            queue       = { task.attempt > 1 ? 'large-ondemand' : 'small-ondemand' }
            container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_parabricks-metrics_1.0.3"
            errorStrategy = { task.attempt <=2 ? 'retry' : 'terminate' }
            cpus        = { 2 * task.attempt }
            memory      = { 7.GB * task.attempt }
            time        = { 5.h }
            resourceLabels = common_resource_labels + [
            pipeline_process_name : "MULTIQC_FOR_PARABRICKS"
        ]

    }

    withName: 'REPORT_VERSIONS' {
            queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
            container   = "public.ecr.aws/v2u5x5f1/basejumper:ubuntu_24.04_stable"
            cpus        = 1
            memory      = 3.GB
            time        = 1.h
            resourceLabels = 
                common_resource_labels + [
                pipeline_process_name: "REPORT_VERSIONS"
            ]
    }

    withName: 'COUNT_READS_FASTQ' {
            container = "public.ecr.aws/v2u5x5f1/basejumper:count_reads_0.1"
            queue       = { task.attempt > 1 ? 'large-spot' : 'small-spot' }
            cpus        = { 2 * task.attempt }
            memory      = { 7.GB * task.attempt }
            time        = { 2.h * task.attempt }
            resourceLabels = 
                common_resource_labels + [
                pipeline_process_name: "COUNT_READS_FASTQ"
            ]
    }

    withName: 'COMBINE_READ_COUNTS' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:count_reads_0.1"
        queue = 'small-spot'
        cpus = 1
        memory = 3.GB
        time = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "COMBINE_READ_COUNTS"
        ]
    }

    withName: 'SEQTK_SAMPLE' {
            container   = "quay.io/biocontainers/seqtk:1.3--h5bf99c6_3"
            queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
            cpus        = 2
            memory      = 7.GB
            time        = 10.h
            resourceLabels = 
                common_resource_labels + [
                pipeline_process_name: "SEQTK_SAMPLE"
            ]
    }

    withName: 'CUSTOM_FASTQ_MERGE' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:ubuntu_24.04_stable"
        queue = 'small-spot'
        cpus        = 2
        memory      = 3.GB
        time        = 2.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_FASTQ_MERGE"
        ]
    }

    withName: 'FASTP' {
        container   = "quay.io/biocontainers/fastp:0.20.1--h8b12597_0"
        ext.args = { 
            if (manifest.name == 'BJ-Expression') {
                return '--disable_adapter_trimming'
            } else  {
                return "--adapter_sequence=${params.adapter_sequence} --adapter_sequence_r2=${params.adapter_sequence_r2}"
            }
        }
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        cpus        = { 2 * task.attempt }
        memory      = { 7.GB * task.attempt }
        time        = { 2.h * task.attempt }
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "FASTP"
        ]
    }

    withName: 'CUSTOM_DATA_PROCESSING' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_bj-dna-qc_1.3.3"
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_DATA_PROCESSING"
        ]
    }

    withName: 'CUSTOM_REPORT' {
        queue       = { task.attempt > 1 ? 'large-spot' : 'small-spot' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_bj-dna-qc_1.5"
        cpus        = { 2 * task.attempt }
        memory      = { 7.GB * task.attempt }
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_REPORT"
        ]
    }

    withName: 'CUTADAPT' {
        container   = "quay.io/biocontainers/cutadapt:4.9--py311hdad781d_2"
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        cpus        = { 2 * task.attempt }
        memory      = { 7.GB * task.attempt }
        time        = { 2.h * task.attempt }
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUTADAPT"
        ]
    }

    withName: 'SENTIEON_DRIVER_METRICS' {
        queue = { params.architecture == 'arm' ? 'small-arm-spot' : 'small-spot' }
        container = {
            params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
            : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        cpus        = 2
        memory      = 3.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_METRICS"
        ]
    }

    withName: 'SENTIEON_DRIVER_LOCUSCOLLECTOR' {
        queue = { params.architecture == 'arm' ? 'small-arm-spot' : 'small-spot' }
        container = {
        params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
        : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        cpus        = 1
        memory      = 1.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_LOCUSCOLLECTOR"
        ]
    }
        
    withName: 'SENTIEON_DRIVER_DEDUP' {
        queue = { params.architecture == 'arm' ? 'large-arm-spot' : 'large-spot' }
        container = {
            params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
            : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        cpus        = 8
        memory      = 15.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_DEDUP"
        ]
    }
    
    withName: "BAM_TO_BED" {
        container   = "quay.io/biocontainers/bedtools:2.28.0--hdf88d34_0"
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 1
        memory      = 3.GB
        time        = { 2.h * task.attempt }
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BAM_TO_BED"
        ]
    }

    withName: "GINKGO_BINUNSORT" {
        container   = "public.ecr.aws/v2u5x5f1/basejumper:ginkgo_0.2"
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "GINKGO_BINUNSORT"
        ]
    }
    
    withName: "GINKGO_SEGMENTATION_R" {
        container   = "public.ecr.aws/v2u5x5f1/basejumper:ginkgo_0.2"
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "GINKGO_SEGMENTATION_R"
        ]
    }
        
    withName: "GINKGO_CNV_CALLER" {
        container   = "public.ecr.aws/v2u5x5f1/basejumper:ginkgo_0.2"
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "GINKGO_CNV_CALLER"
        ]

    }
    
    withName: "GINKO_RDS_TO_FLAT" {
        container   = "public.ecr.aws/v2u5x5f1/basejumper:ginkgo_0.2"
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "GINKO_RDS_TO_FLAT"
        ]
    }    
        
    withName: "GINKO_PARSE_OUTPUTS" {
        container   = "public.ecr.aws/v2u5x5f1/basejumper:ginko_parser_0.2.1"
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "GINKO_PARSE_OUTPUTS"
        ]

    }
    
    withName: "PARSE_RDS_CNV_METRICS" {
        container   = "public.ecr.aws/v2u5x5f1/basejumper:ginkgo_0.3"
        errorStrategy = 'ignore'
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "PARSE_RDS_CNV_METRICS"
        ]
    }
        
    withName: 'KRAKEN2' {
        container   = "quay.io/biocontainers/kraken2:2.1.3--pl5321hdcf5f25_0"
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        cpus        = 4
        memory      = 15.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "KRAKEN2"
        ]

    }
        
    withName: 'FASTQC' {
        container   = "quay.io/biocontainers/fastqc:0.11.9--hdfd78af_1"
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        cpus        = 4
        memory      = 15.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "FASTQC"
        ]
    }
        
    withName: 'SENTIEON_BWA_MEM' {
        queue = { params.architecture == 'arm' ? 'large-arm-spot' : 'large-spot' }
        container = {
            params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
            : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        cpus        = 8
        memory      = 15.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_BWA_MEM"
        ]
    }
        
    withName: 'BAM_LORENZ_COVERAGE' {
        container   = "public.ecr.aws/v2u5x5f1/basejumper:bam_lorenz_coverage_v1"
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 2
        memory      = 7.GB
        time        = 2.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "BAM_LORENZ_COVERAGE"
        ]
    }

    withName: 'QUALIMAP_BAMQC' {
        container   = "public.ecr.aws/v2u5x5f1/basejumper:quay_qualimap_2.2.2d--1"
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "QUALIMAP_BAMQC"
        ]
    }
        
    withName: 'PRESEQ_BAM2MR' {
        container   = "public.ecr.aws/v2u5x5f1/basejumper:preseq_bam2mr_0.1"
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "PRESEQ_BAM2MR"
        ]
    }
    
    withName: 'PRESEQ_GC_EXTRAP' {
        container   = "public.ecr.aws/v2u5x5f1/basejumper:preseq_bam2mr_0.1"
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = common_resource_labels + [
            pipeline_process_name: "PRESEQ_GC_EXTRAP"
        ]
    }
    
    withName: 'CUSTOM_CALCULATE_MAPD' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_bj-dna-qc_1.3.1"
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_CALCULATE_MAPD"
        ]
    }

    withName: 'SENTIEON_DRIVER_COVERAGEMETRICS' {
        queue = { params.architecture == 'arm' ? 'large-arm-spot' : 'large-spot' }
        container = {
            params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
            : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        errorStrategy = { task.attempt <=1 ? 'retry' : 'ignore' }
        cpus            = 2
        memory          = 30.GB
        time            = 2.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_COVERAGEMETRICS"
        ]
    }

    withName: 'SENTIEON_ALIGNMENT' {
        queue = { params.architecture == 'arm' ? 'intense-arm-spot' : 'intense-spot' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        maxForks    = 8 
        container = {
            params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
            : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        cpus        = 64
        memory      = 123.GB
        time        = 24.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_ALIGNMENT"
        ]
    }

    withName: 'SENTIEON_ALGORITHM' {
        queue = { params.architecture == 'arm' ? 'intense-arm-spot' : 'intense-spot' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        maxForks    = 8 
        container = {
            params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
            : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        cpus        = 64
        memory      = 123.GB
        time        = 24.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_ALGORITHM"
        ]
    }

    withName: 'SENTIEON_DNASCOPE' {
        queue       = { task.attempt <= 1 ? 'intense-spot' : 'intense-ondemand' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        container = 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        cpus        = 64
        memory      = 123.GB
        time        = 24.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DNASCOPE"
        ]
    }

    withName: 'PREPROCESS_VCF' {
        
        container = "public.ecr.aws/v2u5x5f1/basejumper:variantannotation_0.4"
        errorStrategy   = 'ignore'
        queue = 'small-spot'
        cpus = 2
        memory = 7.GB
        time = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PREPROCESS_VCF"
        ]
    }

    withName: 'MERGE_PROCESSED_VCF' {

      container = "quay.io/biocontainers/bcftools:1.21--h8b25389_0"
      errorStrategy = 'retry'
      queue = 'intense-spot'
      cpus  = 60
      memory  = 243.GB
      time = 48.h
      resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "MERGE_PROCESSED_VCF"
     ]
  }

    withName: 'SNPEFF_ANNOTATION' {
        queue       = { task.attempt <= 1 ? 'large-spot' : 'intense-ondemand' }
        container   = "quay.io/biocontainers/snpeff:5.1--hdfd78af_2"
        cpus        = { 2 * task.attempt }
        memory      = { task.attempt <= 1 ? 30.GB : 60.GB }
        time        = 5.h
        maxRetries  = 1
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SNPEFF_ANNOTATION"
        ]
    }
    
    withName: 'BCFTOOLS_VIEW' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = 'quay.io/biocontainers/bcftools:1.14--h88f3f91_0'
        cpus        = 4
        memory      = 15.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BCFTOOLS_VIEW"
        ]
    }
    
    withName: 'SENTIEON_HAPLOTYPER' {
        queue = { params.architecture == 'arm' ? 'intense-arm-spot' : 'intense-spot' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        container = {
            params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
            : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        cpus        = 64
        memory      = 123.GB
        time        = 24.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_HAPLOTYPER"
        ]
    }
    
    withName: 'BCFTOOLS_QUERY_L' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container = "quay.io/biocontainers/bcftools:1.14--h88f3f91_0"
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BCFTOOLS_QUERY_L"
        ]

    }
    
    withName: 'VCFEVAL' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = 'quay.io/biocontainers/rtg-tools:3.12.1--hdfd78af_0'
        cpus        = 2
        memory      = 30.GB
        time        = 2.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "VCFEVAL"
        ]
    }

    withName: 'ANNOT_VCF_WITH_VCFEVAL' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'quay.io/biocontainers/bcftools:1.18--h8b25389_0'
        cpus        = 2
        memory      = 3.GB
        time        = 10.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "ANNOT_VCF_WITH_VCFEVAL"
        ]
    }
    
    withName: 'CONCAT_VCFEVAL_RESULTS' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:ubuntu_24.04_stable'
        cpus        = 1
        memory      = 3.GB
        time        = 10.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CONCAT_VCFEVAL_RESULTS"
        ]
    }
     
    withName: 'DETERMINE_EXPECTED_NEGATIVES' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:bedtools-v2.28.0_cv2'
        cpus        = 1
        memory      = 7.GB
        time        = 2.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "DETERMINE_EXPECTED_NEGATIVES"
        ]
    }
    
    withName: 'DETERMINE_TOTAL_NEGATIVES' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:utility-lite-0.1.0'
        cpus        = 1
        memory      = 7.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "DETERMINE_TOTAL_NEGATIVES"
        ]
    }
    
    withName: 'CREATE_VCFEVAL_OVERALL_METRICS' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:r_ado_1.4'
        cpus        = 1
        memory      = 7.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CREATE_VCFEVAL_OVERALL_METRICS"
        ]
    }

    withName: 'IDENTIFY_GERMLINE_HETS' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:utility-lite-0.1.0'
        cpus        = 4
        memory      = 15.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "IDENTIFY_GERMLINE_HETS"
        ]
    }

    withName: 'EXTRACT_HET_SITES' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:utility-lite-0.1.0'
        cpus        = 2
        memory      = 7.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "EXTRACT_HET_SITES"
        ]
    }
    
    withName: 'SLICE_HET_INTERVALS' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:utility-lite-0.1.0'
        cpus        = 2
        memory      = 7.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SLICE_HET_INTERVALS"
        ]
    }

    withName: 'CREATE_ADO_TABLE' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:utility-lite-0.1.0'
        cpus        = 4
        memory      = 15.GB
        time        = 24.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CREATE_ADO_TABLE"
        ]
    }

    withName: 'SUMMARIZE_ADO_INTERVALS' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:r_ado_1.3.2'
        cpus        = 2 
        memory      = 7.GB
        time        = 8.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SUMMARIZE_ADO_INTERVALS"
        ]
    }

    withName: 'CONCAT_SUMMARY_ADO_INTERVALS' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:r_ado_1.3.2'
        cpus        = 2 
        memory      = 7.GB
        time        = 8.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CONCAT_SUMMARY_ADO_INTERVALS"
        ]
    }
    
    withName: 'PICARD_COLLECTHSMETRICS' {
        container   = "quay.io/biocontainers/picard:3.0.0--hdfd78af_0"
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        cpus        = 4
        memory      = 8.GB
        time        = 5.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PICARD_COLLECTHSMETRICS"
        ]
    }

    withName: 'PICARD_COLLECTWGSMETRICS' {
        container   = "quay.io/biocontainers/picard:3.0.0--hdfd78af_0"
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        cpus        = 8
        memory      = 30.GB
        time        = 6.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PICARD_COLLECTWGSMETRICS"
        ]
    }

    withName: 'SENTIEON_DRIVER_TNSCOPE' {
        queue = { params.architecture == 'arm' ? 'intense-arm-spot' : 'intense-spot' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        maxForks    = 8
        container = {
            params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
            : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        cpus        = 64
        memory      = 123.GB
        time        = 24.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_TNSCOPE"
        ]
    }

    withName: 'SENTIEON_DRIVER_TNSCOPE_PANEL_OF_NORMAL' {
    queue = { params.architecture == 'arm' ? 'intense-arm-spot' : 'intense-spot' }
    errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
    maxForks    = 8
    container = {
        params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
        : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
    }
    cpus        = 64
    memory      = 123.GB
    time        = 24.h
    resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_TNSCOPE_PANEL_OF_NORMAL"
        ]
    }

    withName: 'SENTIEON_DRIVER_TNSCOPE_TUMOR_PANEL_OF_NORMAL' {
        queue = { params.architecture == 'arm' ? 'intense-arm-spot' : 'intense-spot' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        maxForks    = 8
        container = {
            params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
            : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        cpus        = 64
        memory      = 123.GB
        time        = 24.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_TNSCOPE_TUMOR_PANEL_OF_NORMAL"
        ]
    }


    withName: 'GENERATE_PANEL_OF_NORMAL' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'quay.io/biocontainers/bcftools:1.14--h88f3f91_0'
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "GENERATE_PANEL_OF_NORMAL"
        ]
    }

    withName: 'SENTIEON_DRIVER_TNSEQ' {
        queue = { params.architecture == 'arm' ? 'intense-arm-spot' : 'intense-spot' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        maxForks    = 8
        container = {
            params.architecture == 'arm' ? 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-arm-202308-01'
            : 'public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1'
        }
        cpus        = 64
        memory      = 123.GB
        time        = 24.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_TNSEQ"
        ]
    }

    withName: 'MERGE_VCFS' {   
        container = "public.ecr.aws/v2u5x5f1/basejumper:variantannotation_0.3"
        errorStrategy = { task.attempt <= 1 ? 'retry' : 'ignore' }
        queue       = { task.attempt <= 1 ? 'large-spot' : 'large-ondemand' }
        cpus = 4
        memory = 15.GB
        time = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "MERGE_VCFS"
        ]
    }
       
    withName: 'VARIANTQC' {            
        container = "public.ecr.aws/v2u5x5f1/basejumper:discvrseq-1.20"
        errorStrategy   = 'ignore'
        queue = 'large-spot'
        cpus = 8
        memory = 30.GB
        time = 5.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "VARIANTQC"
        ]
    }

    withName: 'CONCAT_VCFS' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:variantannotation_0.3"
        errorStrategy   = 'ignore'
        queue = 'small-spot'
        cpus = 2
        memory = 7.GB
        time = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CONCAT_VCFS"
        ]
    }

    withName: 'GATK_VARIANTSTOTABLE' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = "broadinstitute/gatk:4.1.3.0"
        cpus        = 4
        memory      = 15.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "GATK_VARIANTSTOTABLE"
        ]
    }

    withName: 'SAMTOOLS_CRAMTOBAM' {
        container   = "quay.io/biocontainers/samtools:1.15.1--h1170115_0"
        queue       = { task.attempt <= 1 ? 'intense-spot' : 'intense-ondemand' }
        cpus        = 64
        memory      = 123.GB
        time        = 24.h

        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SAMTOOLS_CRAMTOBAM"
        ]
    }

    withName: 'SET_PSEUDO_BULK' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:somatic_variant_calling_0.2"
        queue = 'small-spot'
        cpus = 1
        memory = 3.GB
        time = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SET_PSEUDO_BULK"
        ]
    }

    withName: 'COUNT_READS' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:count_reads_0.1"
        queue = 'small-spot'
        cpus = 2
        memory = 7.GB
        time = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "COUNT_READS"
        ]
    }

    withName: 'CUSTOM_BAM_CONCATENATE_FILES' {
        container = "quay.io/biocontainers/samtools:1.15.1--h1170115_0"
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        cpus        = 4
        memory      = 8.GB
        time = 5.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_BAM_CONCATENATE_FILES"
        ]
    }

    withName: 'CUSTOM_BAM_SUBSAMPLE' {
        container = "quay.io/biocontainers/samtools:1.15.1--h1170115_0"
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        cpus        = 4
        memory      = 8.GB
        time = 5.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_BAM_SUBSAMPLE"
        ]
    }

    withName: 'PICARD_ADDORREPLACEREADGROUPS' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:picard_addorreplacegroups_3.1.2"
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        cpus        = 4
        memory      = 8.GB
        time = 5.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PICARD_ADDORREPLACEREADGROUPS"
        ]
    }

    withName: 'VARIANT_ANNOTATION_VEP' {            
        container = "public.ecr.aws/v2u5x5f1/basejumper:variantannotation_0.3"
        errorStrategy   = 'ignore'
        queue = 'small-spot'
        cpus = 2
        memory = 7.GB
        time = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "VARIANT_ANNOTATION_VEP"
        ]
    }

    withName: 'SPLIT_VCF_BY_CHR' {            
        container = "public.ecr.aws/v2u5x5f1/basejumper:variantannotation_0.3"
        errorStrategy   = 'ignore'
        queue = 'small-spot'
        cpus = 2
        memory = 7.GB
        time = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SPLIT_VCF_BY_CHR"
        ]
    }

    withName: 'CUSTOM_SPLIT_BAM_CHR' {      
        container = "quay.io/biocontainers/samtools:1.18--h50ea8bc_1"
        queue = 'small-spot'
        cpus  = 2
        memory  = 7.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SPLIT_VCF_BY_CHR"
        ]
    }        
        
    withName: 'CUSTOM_SPLIT_QUERY_TABLE_CHR' {            
        container = "public.ecr.aws/v2u5x5f1/basejumper:utility-lite-0.1.0"
        queue = 'small-spot'
        cpus  = 2
        memory  = 7.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SPLIT_VCF_BY_CHR"
        ]
    }

    withName: 'CUSTOM_BAM_PILEUP_FILTER' {      
        container = "quay.io/biocontainers/samtools:1.18--h50ea8bc_1"
        queue = 'small-spot'
        cpus  = 2
        memory  = 7.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_BAM_PILEUP_FILTER"
        ]
    }
        
    withName: 'CUSTOM_RSCRIPT_SOMATICSNP_FILTER_1_CELL_LEVEL_CREATE_TABLE' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.2"
        errorStrategy = 'ignore'
        queue = 'small-spot'
        cpus  = 2
        memory  = 7.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_RSCRIPT_SOMATICSNP_FILTER_1_CELL_LEVEL_CREATE_TABLE"
        ]
    }
        

    withName: 'CUSTOM_RSCRIPT_SOMATICSNP_FILTER_2_CELL_LEVEL_CONCAT_FILTER_TABLE' {            
        container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.2"
        errorStrategy = 'ignore'
        queue = 'small-spot'
        cpus  = 2
        memory  = 7.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_RSCRIPT_SOMATICSNP_FILTER_2_CELL_LEVEL_CONCAT_FILTER_TABLE"
        ]
    }
    
    withName: 'CUSTOM_GET_LIST_POS_GROUP' {            
        container = "public.ecr.aws/v2u5x5f1/basejumper:utility-lite-0.1.0"
        errorStrategy = 'ignore'
        queue = 'small-spot'
        cpus  = 2
        memory  = 7.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_GET_LIST_POS_GROUP"
        ]
    }
    
    withName: 'CUSTOM_BAM_GROUP_PILEUP' {            
        container = "quay.io/biocontainers/samtools:1.21--h50ea8bc_0"
        errorStrategy = 'retry'
        queue = 'small-spot'
        cpus  = 2
        memory  = 7.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_BAM_GROUP_PILEUP"
        ]
    }

    withName: 'CREATE_TAB_NVNR' {
      container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.6"
      errorStrategy = 'retry'
      queue = 'small-spot'
      cpus  = 2
      memory  = 7.GB
      time = 24.h
      resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CREATE_TAB_NVNR"
        ]

  }
    
    withName: 'CUSTOM_RSCRIPT_SOMATICSNP_FILTER_3_GROUPLEVEL_PROCESS_PILEUP_SAMPLE' {            
        container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.2"
        errorStrategy = 'ignore'
        queue = 'small-spot'
        cpus  = 2
        memory  = 7.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_RSCRIPT_SOMATICSNP_FILTER_3_GROUPLEVEL_PROCESS_PILEUP_SAMPLE"
        ]
    }
    
    withName: 'CUSTOM_RSCRIPT_SOMATICSNP_FILTER_4_CREATE_TABNR_TABNV' {            
        container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.2"
        errorStrategy = 'ignore'
        queue = 'large-spot'
        cpus  = 4
        memory  = 15.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_RSCRIPT_SOMATICSNP_FILTER_4_CREATE_TABNR_TABNV"
        ]
    }

    withName: 'CUSTOM_RSCRIPT_SOMATICSNP_FILTER_1_SAMPLELEVEL_PROCESS_PILEUP_SAMPLE_CIGAR' {            
        container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.6"
        errorStrategy = 'retry'
        queue = 'small-spot'
        cpus  = 2
        memory  = 7.GB
        time = 24.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_RSCRIPT_SOMATICSNP_FILTER_1_SL_PPSC"
        ]
    }

    withName: 'SEQUOIA_BINOM_BETABINOM_TAB_NV_NR' {
      container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.6"
      errorStrategy = 'retry'
      queue = 'large-spot'
      cpus  = 16
      memory  = 60.GB
      time = 48.h
      resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SEQUOIA_BINOM_BETABINOM_TAB_NV_NR"
        ]

    }

    withName: 'CONCAT_FILTER_BINOM_BETABINOM_TAB_NV_NR' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.6"
        errorStrategy = 'retry'
        queue = 'intense-spot'
        cpus  = 64
        memory  = 243.GB
        time = 48.h
        resourceLabels = 
                common_resource_labels + [
                pipeline_process_name: "CONCAT_FILTER_BINOM_BETABINOM_TAB_NV_NR"
            ]

    }

    withName: 'CUSTOM_CREATE_GROUP_LEVEL_TAB_DFS' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.6"
        errorStrategy = 'retry'
        queue = 'large-spot'
        cpus  = 4
        memory  = 15.GB
        time = 24.h
        resourceLabels = 
                common_resource_labels + [
                pipeline_process_name: "CUSTOM_CREATE_GROUP_LEVEL_TAB_DFS"
            ]

    }

    withName: 'CUSTOM_SOMATIC_SNPINDEL_FILTERRAWTABLES' {
      container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.6"
      errorStrategy = { task.attempt <=2 ? 'retry' : 'ignore' }
      queue = 'large-spot'
      cpus  = 4
      memory  = 15.GB
      time = 24.h
      resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_SOMATIC_SNPINDEL_FILTERRAWTABLES"
        ]
    }
    
    withName: 'SEQUOIA' {            
        container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.6"
        errorStrategy = 'retry'
        queue = 'intense-spot'
        cpus  = 64
        memory  = 243.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SEQUOIA"
        ]
    }

    withName: 'POSTPROCESS_SEQUOIA_DRAWVAFHEAT_TREE' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:custom_snp_somatic_filter_sequoia_0.6"
        errorStrategy = 'ignore'
        queue = 'large-spot'
        cpus  = 4
        memory  = 15.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "POSTPROCESS_SEQUOIA_DRAWVAFHEAT_TREE"
        ]
    }
    
    withName: 'SUBSET_VCF_VARIANTS' {            
        container = "quay.io/biocontainers/bcftools:1.21--h8b25389_0"
        errorStrategy = 'ignore'
        queue = 'small-spot'
        cpus  = 2
        memory  = 7.GB
        time = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SUBSET_VCF_VARIANTS"
        ]
    }

    withName: 'SALMONQUANT' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        container   = "quay.io/biocontainers/salmon:1.6.0--h84f40af_0"
        cpus        = 8
        memory      = 31.GB
        time        = { 6.h * task.attempt }
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SALMONQUANT"
        ]
    }

    withName: 'CREATE_TXIMPORT_SALMON_TX_GENE' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_r_nf_rnaseq_0.10"
        cpus        = 2
        memory      = 7.GB
        time        = 2.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CREATE_TXIMPORT_SALMON_TX_GENE"
        ]
    }

    withName: 'MERGE_TXIMPORT_SALMON_TX_GENE' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_r_nf_rnaseq_0.10"
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "MERGE_TXIMPORT_SALMON_TX_GENE"
        ]
    }
    
    withName: 'CREATE_MATRIX_SALMON_TX_GENE' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_r_nf_rnaseq_0.10"
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CREATE_MATRIX_SALMON_TX_GENE"
        ]
    }  
        
    withName: 'STARALIGN' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:quay_star_2.7.6a--0"
        cpus        = 16
        memory      = 60.GB
        time        = { 6.h * task.attempt }
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "STARALIGN"
        ]
    }
    
    withName: 'QUALIMAP_BAMRNA' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:quay_qualimap_2.2.2d--1'
        cpus        = 16
        memory      = 60.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "FAQUALIMAP_BAMRNASTP"
        ]
    }
    
    withName: 'STARGETPRIM' {
        queue       = { task.attempt <= 1 ? 'small-spot' : 'large-ondemand' }
        container   = 'quay.io/biocontainers/samtools:1.10--h2e538c0_3'
        cpus        = { 2 * task.attempt }
        memory      = { task.attempt <= 1 ? 7.GB : task.attempt == 2 ? 30.GB : 60.GB }
        time        = { 4.h * task.attempt }
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "STARGETPRIM"
        ]
    }

    withName: 'HTSEQ_COUNTS' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'quay.io/biocontainers/htseq:0.13.5--py38h803c66d_1'
        cpus        = 2
        memory      = 7.GB
        time        = { 12.h * task.attempt }
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "HTSEQ_COUNTS"
        ]
    }
    
    withName: 'CREATE_HTSEQ_SUMMARY' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_r_nf_rnaseq_0.10"
        errorStrategy   = 'ignore'
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CREATE_HTSEQ_SUMMARY"
        ]
    }
    
    withName: 'MERGE_HTSEQ_SUMMARY' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_r_nf_rnaseq_0.10"
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "MERGE_HTSEQ_SUMMARY"
        ]
    }
    
    withName: 'CREATE_HTSEQ_MATRIX' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_r_nf_rnaseq_0.10"
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CREATE_HTSEQ_MATRIX"
        ]
    }
        
    withName: 'PLOTTER_PCAHEATMAP_HTSEQ_SUMMARY' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        errorStrategy   = 'ignore'
        container   = "public.ecr.aws/v2u5x5f1/basejumper:custom_r_nf_rnaseq_0.9"
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PLOTTER_PCAHEATMAP_HTSEQ_SUMMARY"
        ]
    }
    
    withName: 'CELL_TYPING' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        errorStrategy   = 'ignore'
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:rnaseq_celltype_0.4'
        cpus        = 16
        memory      = 60.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CELL_TYPING"
        ]
    }
    
    withName: 'CREATE_QC_REPORT' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:custom_r_nf_rnaseq_0.10'
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CREATE_QC_REPORT"
        ]
    }
    
    withName: 'GENE_BODY_COVERAGE_RNA' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:gene_body_coverage_0.2.1'
        cpus        = 2
        memory      = 7.GB
        time        = { 3.h * task.attempt }
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "GENE_BODY_COVERAGE_RNA"
        ]
    }    
        
    withName: 'GENE_BODY_COVERAGE_RNA_PLOT' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:gene_body_coverage_0.2.1'
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "GENE_BODY_COVERAGE_RNA_PLOT"
        ]
    }
    
    withName: 'CREATE_MASTER_STATS' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:custom_r_nf_rnaseq_0.12'
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CREATE_MASTER_STATS"
        ]
    }
    
    withName: 'ALEVIN_NOQUANT_DUMPFQ' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = "quay.io/biocontainers/salmon:1.6.0--h84f40af_0"
        cpus        = 8
        memory      = 31.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "ALEVIN_NOQUANT_DUMPFQ"
        ]
    }

    withName: 'CUSTOM_AWK_DEMUX_CBC_FASTQ' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:ubuntu_24.04_stable'
        cpus        = 2
        memory      = 7.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_AWK_DEMUX_CBC_FASTQ"
        ]
    }

    withName: 'CALC_DYNAMICRANGE' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:custom_r_nf_rnaseq_0.10'
        cpus        = 2
        memory      = 7.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CALC_DYNAMICRANGE"
        ]
    }

    withName: 'SENTIEON_DRIVER_RNA_SPLIT_READS_JUNCTIONS' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1"
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        queue           = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus            = 2
        memory          = 7.GB
        time            = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_RNA_SPLIT_READS_JUN"
        ]
    }
    
    withName: 'SENTIEON_DRIVER_BQSR' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1"
        errorStrategy = { task.attempt <=1 ? 'retry' : 'ignore' }
        queue           = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus            = 2
        memory          = 7.GB
        time            = 12.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_BQSR"
        ]
    }

    withName: 'SENTIEON_DRIVER_RNA_HAPLOTYPER_DNASCOPE' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:sentieon-202308-01-1"
        errorStrategy = { task.attempt <=1 ? 'retry' : 'ignore' }
        queue           = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus            = 2
        memory          = 7.GB
        time            = 12.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SENTIEON_DRIVER_RNA_HAPLOTYPER_DNASC"
        ]
    }
        
    withName: 'Manta' {
        queue = 'large-ondemand'
        container   = 'quay.io/biocontainers/manta:1.6.0--h9ee0642_3'
        cpus = 8
        memory = 31.GB
        time = 18.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "Manta"
        ]
    }

    withName: 'ExpansionHunter' {
        queue = 'large-ondemand'
        container   = 'quay.io/biocontainers/expansionhunter:5.0.0--h91c6037_3'
        cpus = 8
        memory = 31.GB
        time = 18.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "ExpansionHunter"
        ]
    }
        
    withName: 'PARABRICKS_HAPLOTYPER_GERMLINE' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:parabricks_4.4.0-1"
        errorStrategy   = 'ignore'
        queue = 'intense-gpu-spot'
        accelerator = 4
        cpus = 48
        memory = 180.GB
        time = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PARABRICKS_HAPLOTYPER_GERMLINE"
        ]
    }

    withName: 'PARABRICKS_DEEPVARIANT_GERMLINE' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:parabricks_4.4.0-1"
        errorStrategy   = 'ignore'
        queue = 'intense-gpu-spot'
        accelerator = 4
        cpus = 48
        memory = 180.GB
        time = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PARABRICKS_DEEPVARIANT_GERMLINE"
        ]
        
    }
    
    withName: 'PARABRICKS_DEEPVARIANT' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:parabricks_4.4.0-1"
        errorStrategy   = 'ignore'
        queue = 'intense-gpu-spot'
        accelerator = 4
        cpus = 48
        memory = 180.GB
        time = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PARABRICKS_DEEPVARIANT"
            ]
        
    }
    
    withName: 'PARABRICKS_BAMMETRICS' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:parabricks_4.4.0-1"
        errorStrategy = { task.attempt <= 2 ? 'retry' : 'ignore' }
        maxRetries = 2
        containerOptions = '--gpus all'
        queue = { task.attempt <= 1 ? 'intense-4gpu-spot' : 'intense-4gpu-ondemand' }
        accelerator = 4
        cpus = 48
        memory = 180.GB
        time = 5.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PARABRICKS_BAMMETRICS"
        ]
    }
  
    withName: 'PARABRICKS_COLLECTMULTIPLEMETRICS' {
        
        container = "public.ecr.aws/v2u5x5f1/basejumper:parabricks_4.4.0-1"
        errorStrategy = { task.attempt <= 2 ? 'retry' : 'ignore' }
        maxRetries = 2
        containerOptions = '--gpus all'
        queue = { task.attempt <= 2 ? 'intense-gpu-spot' : 'intense-gpu-ondemand' }
        accelerator = 1
        cpus = 8
        memory = 30.GB
        time = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PARABRICKS_COLLECTMULTIPLEMETRICS"
        ]

    }

    withName: 'PARABRICKS_FQ2BAM' {
        
        container = "public.ecr.aws/v2u5x5f1/basejumper:parabricks_4.4.0-1"
        errorStrategy = { task.attempt <= 2 ? 'retry' : 'ignore' }
        maxRetries = 2
        containerOptions = '--gpus all'
        queue = { task.attempt <= 1 ? 'intense-4gpu-spot' : 'intense-4gpu-ondemand' }
        accelerator = 4
        cpus = 48
        memory = 180.GB
        time = 5.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PARABRICKS_FQ2BAM"
        ]

    }

    withName: 'BCFTOOLS_FILTER' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'quay.io/biocontainers/bcftools:1.14--h88f3f91_0'
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BCFTOOLS_FILTER"
        ]
    }

    withName: 'BCFTOOLS_ISEC' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = 'quay.io/biocontainers/bcftools:1.21--h8b25389_0'
        cpus        = 8
        memory      = 30.GB
        time        = 3.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BCFTOOLS_ISEC"
        ]
    }

    withName: 'BGZIP_TABIX_FILTERD_VCF' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:htslib_1.11_1.0.1"
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BGZIP_TABIX_FILTERD_VCF"
        ]
    }

    withName: 'BGZIP_TABIX' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container = "public.ecr.aws/v2u5x5f1/basejumper:htslib_1.11_1.0.1"
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BGZIP_TABIX"
        ]
    }
    
    withName: 'BCFTOOLS_MERGE' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'quay.io/biocontainers/bcftools:1.14--h88f3f91_0'
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BCFTOOLS_MERGE"
        ]
    }
    
    withName: 'BGZIP_TABIX_MULTISAMPLE_VCF' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:htslib_1.11_1.0.1"
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BGZIP_TABIX_MULTISAMPLE_VCF"
        ]
    }

    withName: 'SNPSIFT_ANNOTATION' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:quay_snpsift_4.3.1t--hdfd78af_3"
        cpus        = 1
        memory      = 15.GB
        time        = 10.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SNPSIFT_ANNOTATION"
        ]
    }
    
    withName: 'SNPSIFT_DBNSFP' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:quay_snpsift_4.3.1t--hdfd78af_3"
        cpus        = 8
        memory      = 30.GB
        time        = 5.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SNPSIFT_DBNSFP"
        ]
    }

    withName: 'CUSTOM_EXPANDED_FIELDS' {
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        container   = "public.ecr.aws/v2u5x5f1/basejumper:variantannotation_0.3"
        cpus        = 16
        memory      = 60.GB
        time        = { 4.h + task.attempt }
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_EXPANDED_FIELDS"
        ]
    }
    
    withName: 'SPLIT_VCF_BY_SAMPLES' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'quay.io/biocontainers/bcftools:1.14--h88f3f91_0'
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SPLIT_VCF_BY_SAMPLES"
        ]
    }
    
    withName: 'TMBler' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/miscellaneous:tmbler_0.3'
        cpus        = 1
        memory      = 3.GB
        time        = 5.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "TMBler"
        ]
    }
    
    withName: 'CUSTOM_COMBINE_METRICS' {
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        container   = 'public.ecr.aws/v2u5x5f1/basejumper:ubuntu_24.04_stable'
        cpus        = 1
        memory      = 3.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_COMBINE_METRICS"
        ]
    }

    withName: 'ULTRAPLEX' {
        container   = "quay.io/biocontainers/ultraplex:1.2.5--py39hf95cd2a_2"
        queue       = 'intense-ondemand'
        errorStrategy   = { task.attempt <=1 ? 'retry' : 'ignore' }
        cpus        = 16
        memory      = 246.GB
        time        = 48.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "ULTRAPLEX"
        ]
    }

    withName: 'BAMSURGEON_ADDSNV' {       
        container = "public.ecr.aws/v2u5x5f1/miscellaneous:bamsurgeon_0.1"
        errorStrategy = { task.attempt <= 1 ? 'retry' : 'ignore' }
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "BAMSURGEON_ADDSNV"
        ]
    }


    withName: 'SIGPROFILERGENERATEMATRIX_MATRIX_GENERATOR' {        
        container = "public.ecr.aws/v2u5x5f1/basejumper:sigprofilermatrixgenerator_1.2.25_2"
        errorStrategy = { task.attempt <= 1 ? 'retry' : 'ignore' }
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SIGPROFILERGENERATEMATRIX_MATRIX_GENERATOR"
        ]
    }    

    withName: 'CUSTOM_MUTATIONCATALOG_MERGER' {        
        container = "public.ecr.aws/v2u5x5f1/basejumper:sigprofilermatrixgenerator_1.2.25_2"
        errorStrategy = { task.attempt <= 1 ? 'retry' : 'ignore' }
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_MUTATIONCATALOG_MERGER"
        ]
    }

    withName: 'SIGPROFILE_HEATMAP' {        
        container = "public.ecr.aws/v2u5x5f1/basejumper:sigprofilermatrixgenerator_1.2.25_4"
        errorStrategy   = 'ignore'
        queue       = { task.attempt <= 2 ? 'small-spot' : 'small-ondemand' }
        cpus        = 2
        memory      = 7.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "SIGPROFILE_HEATMAP"
        ]
    }

    withName: 'CUSTOM_FASTQ_MERGE_DATASETS' {
        container = "public.ecr.aws/v2u5x5f1/basejumper:ubuntu_24.04_stable"
        queue = 'small-spot'
        errorStrategy = { task.attempt <= 1 ? 'retry' : 'ignore' }
        cpus        = 2
        memory      = 3.GB
        time        = 10.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_FASTQ_MERGE_DATASETS"
        ]

    }

    withName: 'PETASUITE_DECOMPRESS' {
        container   = "public.ecr.aws/v2u5x5f1/miscellaneous:petasuite_1.3.11"
        queue       = { task.attempt <= 2 ? 'large-spot' : 'large-ondemand' }
        cpus        = 4
        memory      = 8.GB
        time        = 1.h
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "PETASUITE_DECOMPRESS"
        ]
    }

    withName: 'CUSTOM_PIPELINE_JSON_OUTPUT' {
        resourceLabels = 
            common_resource_labels + [
            pipeline_process_name: "CUSTOM_PIPELINE_JSON_OUTPUT"
        ]
    }

}

